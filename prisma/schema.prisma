// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Modelo de Trabajador (ahora como Usuario)
model Worker {
  id              String       @id @default(uuid())
  username        String       @unique
  email           String?      @unique
  password        String
  phoneNumber     String?
  role            String       @default("empleado")
  status          String       @default("activo")
  leaveRequests   LeaveRequest[]
  taskTypes       TaskType[]
  // Relación de muchos a muchos con el modelo Task
  tasks           Task[]
}

// Nuevo: Modelo para Tipos de Tareas
model TaskType {
  id              String       @id @default(uuid())
  name            String       @unique
  qualifiedWorkers Worker[]
  tasks           Task[]
}

// Modelo de Tarea
model Task {
  id               String       @id @default(uuid())
  name             String
  isCompleted      Boolean      @default(false)
  observations     String?
  taskType         TaskType     @relation(fields: [taskTypeId], references: [id])
  taskTypeId       String
  startTime        DateTime
  endTime          DateTime
  // Relación de muchos a muchos con el modelo Worker
  workers          Worker[]
}

// Modelo de Solicitud de vacaciones o permiso
model LeaveRequest {
  id               String   @id @default(uuid())
  type             String
  startDate        DateTime
  endDate          DateTime
  reason           String?
  status           String   @default("pendiente")
  worker           Worker   @relation(fields: [workerId], references: [id])
  workerId         String
  supervisorId     String?
}